services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false
        bind:
            $apiSecretKey: '%sfs_customer.adapter.stripe.apiSecretKey%'
            $webhookSigningSecret: '%sfs_customer.adapter.stripe.webhookSigningSecret%'
            $logger: '@?monolog.logger.stripe'

    Softspring\PlatformBundle\Platform\Adapter\CustomerAdapterInterface:
        class: Softspring\PlatformBundle\Platform\Adapter\Stripe\CustomerAdapter
        tags:
            - { name: 'sfs_platform.adapter', model: 'customer' }

    Softspring\PlatformBundle\Platform\Adapter\SourceAdapterInterface:
        class: Softspring\PlatformBundle\Platform\Adapter\Stripe\SourceAdapter
        tags:
          - { name: 'sfs_platform.adapter', model: 'source' }

    Softspring\PlatformBundle\Platform\Adapter\AddressAdapterInterface:
        class: Softspring\PlatformBundle\Platform\Adapter\Stripe\AddressAdapter
        tags:
          - { name: 'sfs_platform.adapter', model: 'address' }

    Softspring\PlatformBundle\Platform\Adapter\NotifyAdapterInterface:
        class: Softspring\PlatformBundle\Platform\Adapter\Stripe\NotifyAdapter
        tags:
            - { name: 'sfs_platform.adapter', model: 'notify' }

    Softspring\PlatformBundle\Doctrine\EntityListener\StripeAddressEntityListener:
        tags:
            - { name: 'doctrine.orm.entity_listener', event: 'preUpdate', method: 'preUpdate', entity: '%sfs_customer.address.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }
            - { name: 'doctrine.orm.entity_listener', event: 'prePersist', method: 'prePersist', entity: '%sfs_customer.address.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }
            - { name: 'doctrine.orm.entity_listener', event: 'preRemove', method: 'preRemove', entity: '%sfs_customer.address.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }

    Softspring\PlatformBundle\Doctrine\EntityListener\StripeCustomerEntityListener:
        tags:
            - { name: 'doctrine.orm.entity_listener', event: 'preUpdate', method: 'preUpdate', entity: '%sfs_customer.customer.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }
            - { name: 'doctrine.orm.entity_listener', event: 'prePersist', method: 'prePersist', entity: '%sfs_customer.customer.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }
            - { name: 'doctrine.orm.entity_listener', event: 'preRemove', method: 'preRemove', entity: '%sfs_customer.customer.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }

    Softspring\PlatformBundle\Doctrine\EntityListener\StripeSourceEntityListener:
        tags:
            - { name: 'doctrine.orm.entity_listener', event: 'preUpdate', method: 'preUpdate', entity: '%sfs_customer.source.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }
            - { name: 'doctrine.orm.entity_listener', event: 'prePersist', method: 'prePersist', entity: '%sfs_customer.source.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }
            - { name: 'doctrine.orm.entity_listener', event: 'preRemove', method: 'preRemove', entity: '%sfs_customer.source.class%' } # , entity_manager: '%sfs_customer.entity_manager_name%' }
